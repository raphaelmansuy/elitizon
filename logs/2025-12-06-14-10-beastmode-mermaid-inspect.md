# 2025-12-06-14-10 - Mermaid SVG inspection

## Actions

- Captured `/contact` full-page screenshot: `.playwright-mcp/contact-debug.png`.
- Opened `/blog/autonomy-heartbeat` and inspected all `svg` elements.
- Extracted computed styles and inner HTML for large SVGs (indices 11 and 13).

## Findings

- Mermaid uses HTML labels inside SVG via `<foreignObject>` (flowchart renderer).
- Computed font for those HTML nodes: `Inter, "Inter Fallback", Inter, ui-sans-serif, system-ui, -apple-system, "Helvetica Neue", Arial, sans-serif` and `font-size: 16px` (line-height 24px).
- The SVG internal `<style>` (generated by mermaid) sets `font-size: 14px` for the SVG root (`#mermaid-... { font-size:14px; }`). This mismatch likely causes layout/box sizing differences and label clipping.

## Decision / Next Steps

- Suggested fix: configure mermaid to use the page's computed font-size before rendering (set `themeVariables.fontSize` to `16px`) in addition to `fontFamily` (already set). This will align mermaid's internal layout math with actual rendered label sizes.
- If that doesn't fully resolve clipping, consider embedding the page font into the SVG (`@font-face`) or server-side prerendering of SVGs.

## Lessons/Insights

- Waiting for `document.fonts.ready` is necessary but not sufficient: mermaid uses internal font-size for layout; both `fontFamily` and `fontSize` must be set prior to layout.

---

Task logs saved automatically by the agent.
